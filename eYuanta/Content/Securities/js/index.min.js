function showRealTimeTick(n,t){$.getJSON(window.chartUrl+"/RealTimeTick?stockId="+t+"&marketNo="+n,function(n){drawRealTimeTick(n,"realTimeTickDiv")})}function showIntlFinMarket(){$.getJSON(window.chartUrl+"/IntlFinMarket",function(n){displayIntlFinMarket(n)})}function drawRealTimeTick(n,t){var v,e,f;waitingNewDay=waitingNewDayCheck(n);var i=n.Data,o=[],s=[],h=0,c=[],u=i.length,r=0,l=[["minute",[1]]],a={minute:["%H:%M"],hour:["%H:%M"]};if(orgDataLength=i.length,displayData=[],sumVolume=0,window.realTimeTickDataLength=u,u!=0){if(waitingNewDay&&(v=[],v.push({OpenRefPrice:i[u-1].ClosePrice,Tradedate:i[0].Tradedate,ClosePrice:null,Volume:null,UpPrice:0,UpRate:0}),i=v,u=1,$("#rtVal1").html(""),$("#rtVal2").html(""),$("#rtVal3").html(""),$("#rtVal4").html(""),$("#rtTime").html("")),u<267){for(e=0;e<266-u;e++)i.push({Tradedate:i[u-1].Tradedate+6e4*(e+1),ClosePrice:null,Volume:null,UpPrice:0,UpRate:0});i.push({Tradedate:i[u-1].Tradedate+6e4*(e+5),ClosePrice:null,Volume:null,UpPrice:0,UpRate:0})}for(u=i.length,r;r<u;r+=1)s.push([i[r].Tradedate,i[r].ClosePrice,]),o.push([i[r].Tradedate,formatFloat(i[r].Volume/1e4,2)]),displayData.push({Tradedate:i[r].Tradedate,ClosePrice:i[r].ClosePrice,UpPrice:i[r].UpPrice,UpRate:i[r].UpRate,Volume:i[r].Volume/1e4}),h=i[0].OpenRefPrice,sumVolume=sumVolume+i[r].Volume;if(c.push([i[0].Tradedate,i[0].OpenRefPrice,]),f=$("#"+t).highcharts(),typeof f!="undefined"){f.yAxis[0].options.plotLines[0].value=h;f.yAxis[0].update();f.series[0].update({data:s});f.series[1].update({data:o});f.series[2].update({data:c});return}Highcharts.setOptions({lang:{shortMonths:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],weekdays:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],thousandsSep:""}});Highcharts.stockChart(t,{rangeSelector:{enabled:!1},navigator:{enabled:!1},credits:{enabled:!1},exporting:{enabled:!1},scrollbar:{enabled:!1},tooltip:{split:!0,formatter:function(){var r,u,n,t,i;return $("#rtVal1").html(""),$("#rtVal2").html(""),$("#rtVal3").html(""),$("#rtVal4").html(""),$("#rtTime").html(""),r=[],r.push("<b>"+Highcharts.dateFormat("%H:%M",this.x)+"<\/b>"),typeof this.points!="undefined"&&this.points.forEach(function(n){r.push(n.series.name+": <b>"+formatFloatToStr(n.y,2)+"<\/b>")}),u=this.x,n=$.grep(displayData,function(n){return n.Tradedate==u}),n.length&&(t="",i="",n[0].UpPrice>0?(t="f_color_1",i="▲"):n[0].UpPrice<0&&(t="f_color_2",i="▼"),$("#rtVal2").prop("class",t),$("#rtVal3").prop("class",t),$("#rtVal1").html(formatFloatToStr(n[0].ClosePrice,2)),$("#rtVal2").html(i+formatFloatToStrWoNeg(n[0].UpPrice,2)),$("#rtVal3").html(i+formatFloatToStrWoNeg(n[0].UpRate,2)+"%"),$("#rtVal4").html(formatFloatToStr(n[0].Volume,2)),$("#rtTime").html(Highcharts.dateFormat("%H:%M",this.x))),r}},chart:{backgroundColor:null,events:{render:function(){if(!0==autoFocusLastTooltip&&!1==waitingNewDay){this.series[0].points[orgDataLength-1].setState("hover");this.series[0].points[orgDataLength-1].state="";var n=[];this.series.forEach(function(t){t.userOptions.id!="notDisplayLine"&&n.push(t.points[orgDataLength-1])});this.tooltip.refresh(n);$("#rtVal4").html(formatFloatToStr(sumVolume/1e4,2))}waitingNewDay&&(this.series[0].points[orgDataLength-1].setState(""),this.series[0].points[orgDataLength-1].state="",this.tooltip.hide())}}},plotOptions:{series:{events:{mouseOver:function(){autoFocusLastTooltip=!1},mouseOut:function(){autoFocusLastTooltip=!0}}}},yAxis:[{tickAmount:8,opposite:!1,height:"65%",lineWidth:1,showFirstLabel:!1,showLastLabel:!1,plotLines:[{value:h,color:"#ffd170",width:1,zIndex:1}]},{tickAmount:5,opposite:!1,top:"65%",height:"35%",offset:0,lineWidth:1,showFirstLabel:!1,showLastLabel:!1}],xAxis:{gridLineDashStyle:"Solid",gridLineWidth:1},series:[{name:"指數",data:s,dataGrouping:{units:l,dateTimeLabelFormats:a},color:"#e54141",lineWidth:1},{type:"column",name:"成交量",data:o,yAxis:1,dataGrouping:{units:l,dateTimeLabelFormats:a},color:"#7fc5f6",borderWidth:0},{id:"notDisplayLine",type:"scatter",name:"平盤線",data:c,dataGrouping:{units:l,dateTimeLabelFormats:a},marker:{enabled:!1},stickyTracking:!1}]})}}function displayIntlFinMarket(n){for(var i,t,r=0;r<n.Data.length;r+=1)i=n.Data[r],t=i.StockID.replace(".",""),$("#fin_DealPrice_"+t).length&&($("#fin_DealPrice_"+t).html(""),$("#fin_UpPrice_"+t).html(""),i.DealPrice>0?$("#fin_DealPrice_"+t).html(i.DealPrice):$("#fin_DealPrice_"+t).html(i.OpenRefPrice),$("#fin_UpPrice_"+t).html(i.UpPrice),parseFloat(i.UpPrice)>0?($("#fin_UpPrice_"+t).removeClass("f_color_2"),$("#fin_UpPrice_"+t).addClass("f_color_1"),$("#fin_UpPrice_"+t).prepend("+")):parseFloat(i.UpPrice)<0&&($("#fin_UpPrice_"+t).removeClass("f_color_1"),$("#fin_UpPrice_"+t).addClass("f_color_2")))}function appRcmd_close(){$(".appRcmd").css("display","none")}function formatFloat(n,t){var i=Math.pow(10,t);return Math.round(n*i)/i}function formatFloatToStr(n,t){var i=Math.pow(10,t),r=Math.round(n*i)/i;return r.toFixed(t)}function formatFloatToStrWoNeg(n,t){var i=Math.pow(10,t),r=Math.round(n*i)/i;return r.toFixed(t).replace("-","")}function waitingNewDayCheck(n){var t=!1;return n.ClearStick&&n.ClearStick=="Y"&&(t=!0),t}function OpenSystem(n){const t=_globalotp;switch(n){case"h5":OpenNewWindowNoToolBar(t+"?returnurl=NexusWebTrade%2FH5",screen.width,screen.height);break;case"olh5":OpenNewWindowNoToolBar(t+"?returnurl=NexusWebTrade%2FOLH5",screen.width,screen.height);break;case"tsweb":OpenNewWindowNoToolBar(t+"?returnurl=NexusWebTrade%2FAnnounce",screen.width,screen.height);break;default:OpenNewWindowNoToolBar(t+"?returnurl=NexusWebTrade%2FH5",screen.width,screen.height)}}function OpenNewWindowNoToolBar(n,t,i){window.open(n,"_orderWindow_"+(new Date).getTime(),"width="+t+",height="+i+",top=0,left=0,status=0,toolbar=0,location=0,menubar=0,directories=0,resizable=1,scrollbars=1")}var radChecked;$(document).ready(function(){if($(window).scroll(function(){var n=$(window).width();$(this).scrollTop()>100&&n<767?$(".btn_top").css("display","block"):$(".btn_top").css("display","none")}),$(".slides.slides_bn.webcheck").parent().css("display")=="block"){$("#webBannerFirst").css("display","block");$(".slides.slides_bn").on("init",function(){$(".shortcut_webbank").css("display","block");$(".indexSlideItem").css("display","block")});$(".slides.slides_bn.webcheck").slick({dots:!0,infinite:!0,speed:300,slidesToShow:1,slidesToScroll:1,autoplay:!0})}if($(".slides.slides_bn.mobilecheck").parent().css("display")=="block"){$("#mobileBannerFirst").css("display","block");$(".slides.slides_bn").on("init",function(){$(".indexSlideItem").css("display","block")});$(".slides.slides_bn.mobilecheck").slick({lazyLoad:"ondemand",dots:!0,infinite:!0,speed:300,slidesToShow:1,slidesToScroll:1,autoplay:!0}).on("lazyLoaded",function(n,t,i){i.attr("style","display:block")})}$(".block_event_slides").slick({lazyLoad:"progressive",dots:!0,infinite:!0,speed:300,prevArrow:!1,nextArrow:!1,slidesToShow:3,slidesToScroll:1,autoplay:!0,responsive:[{breakpoint:1441,settings:{slidesToShow:3,slidesToScroll:1}},{breakpoint:1281,settings:{slidesToShow:3,slidesToScroll:1}},{breakpoint:1025,settings:{slidesToShow:3,slidesToScroll:1}},{breakpoint:999,settings:{dots:!0,slidesToShow:3,slidesToScroll:1}},{breakpoint:767,settings:{dots:!0,slidesToShow:1,slidesToScroll:1}}]}).on("lazyLoaded",function(n,t,i){i.attr("style","display:block")});if($(".shortcut_all_slides.webcheck").css("display")=="block")$(".shortcut_all_slides.webcheck").slick({lazyLoad:"ondemand",dots:!1,infinite:!0,rows:2,speed:300,slidesToShow:5,slidesToScroll:2,responsive:[{breakpoint:1441,settings:{slidesToShow:5,slidesToScroll:5}},{breakpoint:1281,settings:{slidesToShow:5,slidesToScroll:5}},{breakpoint:1024,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:768,settings:{slidesToShow:3,slidesToScroll:3,dots:!0}}]}).on("lazyLoaded",function(n,t,i){i.attr("style","display:block")});if($(".shortcut_all_slides.mobilecheck").css("display")=="block")$(".shortcut_all_slides.mobilecheck").slick({lazyLoad:"ondemand",dots:!1,infinite:!0,rows:2,speed:300,slidesToShow:5,slidesToScroll:2,responsive:[{breakpoint:1441,settings:{slidesToShow:5,slidesToScroll:5}},{breakpoint:1281,settings:{slidesToShow:5,slidesToScroll:5}},{breakpoint:1024,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:768,settings:{slidesToShow:3,slidesToScroll:3,dots:!0}}]}).on("lazyLoaded",function(n,t,i){i.attr("style","display:block")})});$(function(){var n=0;$(".abgne_tab").each(function(){var t=$(this),i=$("ul.tabs li",t).eq(n).addClass("active");$(i.find("a").attr("href")).siblings().hide();$("ul.tabs li",t).click(function(){var n=$(this),t=n.find("a").attr("href");return n.addClass("active").siblings(".active").removeClass("active"),$(t).stop(!1,!0).fadeIn().siblings().hide(),!1}).find("a").focus(function(){this.blur()})})});radChecked=function(){var n=$('input[name="AuthType"]:checked').val();$(".methodDiv").hide();$("#tabLogin"+n).show()};$(document).ready(function(){radChecked();$('input[name="AuthType"]').on("click",radChecked)});$(document).ready(function(){window.realTimeTickDataLength=0;showRealTimeTick(1,"100000");$("#showRealTimeTick1").on("click",function(){window.realTimeTickDataLength=0;$("#showRealTimeTick1").parent().attr("class","active");$("#showRealTimeTick2").parent().attr("class","");$("#showIntlFinMarketBtn").parent().attr("class","");$("#realTimeTickName").html("加權");showRealTimeTick(1,"100000");$("#data_box_div").show();$("#price_box_div").hide()});$("#showRealTimeTick2").on("click",function(){window.realTimeTickDataLength=0;$("#showRealTimeTick1").parent().attr("class","");$("#showRealTimeTick2").parent().attr("class","active");$("#showIntlFinMarketBtn").parent().attr("class","");$("#realTimeTickName").html("櫃檯");showRealTimeTick(2,"100100");$("#data_box_div").show();$("#price_box_div").hide()});setInterval(function(){$("#showRealTimeTick1").parent().hasClass("active")?showRealTimeTick(1,"100000"):$("#showRealTimeTick2").parent().hasClass("active")&&showRealTimeTick(2,"100100")},6e4)});var displayData=[],orgDataLength=0,autoFocusLastTooltip=!0,sumVolume=0,waitingNewDay=!1;